msrv = "1.90.0"
too-many-arguments-threshold = 5
type-complexity-threshold = 120
cognitive-complexity-threshold = 20

disallowed-names = ["e", "t", "tmp", ".."]

disallowed-macros = [
    { path = "std::print", reason = "no stdout in libs; use tracing/log", allow-invalid = true },
    { path = "std::println", reason = "no stdout in libs; use tracing/log", allow-invalid = true },
    { path = "std::eprint", reason = "no stderr in libs; use tracing/log", allow-invalid = true },
    { path = "std::eprintln", reason = "no stderr in libs; use tracing/log", allow-invalid = true },
    { path = "std::dbg", reason = "no dbg! in libs; use tracing + tests", allow-invalid = true },
    { path = "core::panic", reason = "no panic! in libs; return structured errors", allow-invalid = true },
    { path = "core::todo", reason = "no todo! in libs", allow-invalid = true },
    { path = "core::unimplemented", reason = "no unimplemented! in libs", allow-invalid = true },
]

disallowed-methods = [
    { path = "core::option::Option::unwrap", reason = "no unwrap in libs; use ?/match/if let", allow-invalid = true },
    { path = "core::result::Result::unwrap", reason = "no unwrap in libs; use ?/match", allow-invalid = true },
    { path = "core::option::Option::expect", reason = "no expect in libs; return structured errors", allow-invalid = true },
    { path = "core::result::Result::expect", reason = "no expect in libs; return structured errors", allow-invalid = true },

    { path = "core::mem::transmute", reason = "ban transmute; prefer safe conversions or explicit unsafe with invariants", allow-invalid = true },
    { path = "std::process::exit", reason = "no process::exit in libraries", allow-invalid = true },

    { path = "std::vec::Vec::leak", reason = "no leaking memory", allow-invalid = true },
    { path = "std::boxed::Box::leak", reason = "no leaking memory", allow-invalid = true },
]

disallowed-types = [
    { path = "std::cell::RefCell", reason = "avoid runtime borrow checks; prefer explicit design or safe sync primitives", allow-invalid = true },
    { path = "std::rc::Rc", reason = "prefer Arc in async/multi-thread contexts", replacement = "std::sync::Arc", allow-invalid = true },
]
